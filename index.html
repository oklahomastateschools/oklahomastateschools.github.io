<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hydra Proxy - Tabbed Browser</title>
    <link rel="stylesheet" href="/src/styles.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #121212;
            color: white;
        }

        .tab-container {
            display: flex;
            background: #1e1e1e;
            padding: 5px;
            overflow-x: auto;
            white-space: nowrap;
        }

        .tab {
            background: #333;
            color: white;
            padding: 8px 12px;
            margin: 0 5px;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        .tab.active {
            background: #555;
        }

        .tab span {
            margin-right: 5px;
        }

        .tab .close-btn {
            background: red;
            border: none;
            color: white;
            margin-left: 8px;
            cursor: pointer;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 12px;
            text-align: center;
            line-height: 18px;
        }

        .url-bar {
            display: flex;
            padding: 10px;
            background: #222;
        }

        .url-bar input {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 4px;
            margin-right: 5px;
        }

        .url-bar button {
            padding: 8px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .browser-container {
            width: 100%;
            height: calc(100vh - 90px);
            position: relative;
        }

        .iframe-container {
            width: 100%;
            height: 100%;
            border: none;
            position: absolute;
            display: none;
        }

        .iframe-container.active {
            display: block;
        }
    </style>
</head>
<body>

    <div class="tab-container">
        <button onclick="addTab()">➕ New Tab</button>
    </div>

    <div class="url-bar">
        <input type="text" id="urlInput" placeholder="Enter URL and press Go">
        <button onclick="loadURL()">Go</button>
    </div>

    <div class="browser-container" id="browserContainer">
        <!-- Tabs will be dynamically added here -->
    </div>

    <script>
        let tabCount = 0;
        let activeTabId = null;

        function addTab(url = "https://www.example.com") {
            tabCount++;
            const tabId = "tab" + tabCount;

            // Create new tab button
            const tab = document.createElement("div");
            tab.classList.add("tab");
            tab.setAttribute("id", tabId);
            tab.setAttribute("onclick", `switchTab('${tabId}')`);

            const tabText = document.createElement("span");
            tabText.textContent = "Tab " + tabCount;

            const closeButton = document.createElement("button");
            closeButton.textContent = "×";
            closeButton.classList.add("close-btn");
            closeButton.setAttribute("onclick", `closeTab(event, '${tabId}')`);

            tab.appendChild(tabText);
            tab.appendChild(closeButton);
            document.querySelector(".tab-container").appendChild(tab);

            // Create iframe
            const iframe = document.createElement("iframe");
            iframe.setAttribute("src", url);
            iframe.setAttribute("class", "iframe-container");
            iframe.setAttribute("id", "iframe_" + tabId);
            document.getElementById("browserContainer").appendChild(iframe);

            // Switch to new tab
            switchTab(tabId);
        }

        function switchTab(tabId) {
            activeTabId = tabId;

            // Remove active class from all tabs
            document.querySelectorAll(".tab").forEach(tab => tab.classList.remove("active"));
            document.getElementById(tabId).classList.add("active");

            // Hide all iframes
            document.querySelectorAll(".iframe-container").forEach(iframe => iframe.classList.remove("active"));
            document.getElementById("iframe_" + tabId).classList.add("active");
        }

        function closeTab(event, tabId) {
            event.stopPropagation();

            // Remove tab and iframe
            document.getElementById(tabId).remove();
            document.getElementById("iframe_" + tabId).remove();

            // If the closed tab was active, switch to another
            if (activeTabId === tabId) {
                const remainingTabs = document.querySelectorAll(".tab");
                if (remainingTabs.length > 0) {
                    switchTab(remainingTabs[0].id);
                }
            }
        }

        function loadURL() {
            const urlInput = document.getElementById("urlInput").value;
            if (!urlInput) return;

            const formattedUrl = urlInput.startsWith("http") ? urlInput : "https://" + urlInput;

            if (activeTabId) {
                document.getElementById("iframe_" + activeTabId).setAttribute("src", formattedUrl);
            } else {
                addTab(formattedUrl);
            }
        }

        // Add the first tab on page load
        window.onload = () => addTab();
    </script>

</body>
</html>
